<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Admin Dashboard</title>

    <!-- Montserrat Font -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="admin1.css">
  </head>
  <body>
    <div class="grid-container">

      <!-- Header -->
      <header class="header">
        <h4>RetroDemure.My</h4>
        <div class="header-right">
          <span class="material-icons-outlined">account_circle</span>
        </div>
      </header>
      <!-- End Header -->

      <!-- Sidebar -->
      <aside id="sidebar">
        <div class="sidebar-title">
          <div class="sidebar-brand">
            <span class="material-icons-outlined">inventory</span> RetroDemure's Admin Panel
          </div>
          <span class="material-icons-outlined" onclick="closeSidebar()">close</span>
        </div>

        <ul class="sidebar-list">
          <li class="sidebar-list-item">
            <a href="admin1.html">
              <span class="material-icons-outlined">dashboard</span> Dashboard
            </a>
          </li>
          <li class="sidebar-list-item">
            <a href="product.html">
              <span class="material-icons-outlined">inventory_2</span> Products
            </a>
          </li>
          <li class="sidebar-list-item">
            <a href="inventory.html">
              <span class="material-icons-outlined">fact_check</span> Inventory
            </a>
          </li>
          <li class="sidebar-list-item">
            <a href="vieworder.html">
              <span class="material-icons-outlined">shopping_cart</span> View Orders
            </a>
          </li>
          <li class="sidebar-list-item">
            <a href="review.html">
              <span class="material-icons-outlined">poll</span> Reviews
            </a>
          </li>
          <li class="sidebar-list-item">
            <a href="manageuser.html">
              <span class="material-icons-outlined">settings</span> Manage Users
            </a>
          </li>
          <li class="sidebar-list-item">
            <a href="exportdata.html">
              <span class="material-icons-outlined">dashboard</span> Sales Overview
            </a>
          </li>
        </ul>
      </aside>
      <!-- End Sidebar -->

      <!-- Main -->
      <main class="main-container">
        <div class="main-title">
          <p class="font-weight-bold">Manage Users</p>
        </div>

        <!-- User Search Form -->
        <div class="search-bar">
          <input type="text" id="searchInput" placeholder="Search users by name or email..." />
          <button type="button" class="search-btn">Search</button>
        </div>

        <!-- User Table -->
        <div class="user-table-section">
          <table class="user-table">
            <thead>
              <tr>
                <th>User ID</th>
                <th>Full Name</th>
                <th>Email</th>
                <th>Role</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="user-id">104995142</td>
                <td class="user-name">Mihidu Kumara Hettiarachchi</td>
                <td class="user-email">mihidu01@gmail.com</td>
                <td class="user-role">Admin</td>
                <td>
                  <button class="action-btn edit-btn">Edit</button>
                  <button class="action-btn save-btn" style="display: none;">Save</button>
                  <button class="action-btn delete">Delete</button>
                </td>
              </tr>
              <tr>
                <td class="user-id">104358444</td>
                <td class="user-name">SUDHISH KUMAR</td>
                <td class="user-email">j22039088@student.newinti.edu.my</td>
                <td class="user-role">Admin</td>
                <td>
                  <button class="action-btn edit-btn">Edit</button>
                  <button class="action-btn save-btn" style="display: none;">Save</button>
                  <button class="action-btn delete">Delete</button>
                </td>
              </tr>
              <tr>
                <td class="user-id">104520557</td>
                <td class="user-name">Fattah</td>
                <td class="user-email">j21035670@student.newinti.edu.my</td>
                <td class="user-role">Admin</td>
                <td>
                  <button class="action-btn edit-btn">Edit</button>
                  <button class="action-btn save-btn" style="display: none;">Save</button>
                  <button class="action-btn delete">Delete</button>
                </td>
              </tr>
              <tr>
                <td class="user-id">104179331</td>
                <td class="user-name">Charrand Shager</td>
                <td class="user-email">j21035033@student.newinti.edu.my</td>
                <td class="user-role">Admin</td>
                <td>
                  <button class="action-btn edit-btn">Edit</button>
                  <button class="action-btn save-btn" style="display: none;">Save</button>
                  <button class="action-btn delete">Delete</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Add User Form -->
        <div class="add-user-section">
          <h3>Add New User</h3>
          <form id="addUserForm">
            <label for="userId">User ID:</label>
            <input type="text" id="userId" pattern="\d+" title="User ID must be a number" required>

            <label for="fullName">Full Name:</label>
            <input type="text" id="fullName" required>

            <label for="userEmail">Email:</label>
            <input type="email" id="userEmail" required>

            <label for="userRole">Role:</label>
            <select id="userRole" required>
              <option value="admin">Admin</option>
              <option value="manager">Manager</option>
              <option value="employee">Employee</option>
            </select>

            <button type="submit">Add User</button>
          </form>
        </div>
      </main>
      <!-- End Main -->

    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const editButtons = document.querySelectorAll('.edit-btn');
        const saveButtons = document.querySelectorAll('.save-btn');
        const deleteButtons = document.querySelectorAll('.delete');
        const userRows = document.querySelectorAll('.user-table tbody tr');

        // Toggle edit mode and show the save button
        editButtons.forEach((editBtn, index) => {
            editBtn.addEventListener('click', function() {
                const row = userRows[index];
                const userId = row.querySelector('.user-id');
                const userName = row.querySelector('.user-name');
                const userEmail = row.querySelector('.user-email');
                const userRole = row.querySelector('.user-role');

                // Make the user fields editable
                userId.setAttribute('contenteditable', 'true');
                userName.setAttribute('contenteditable', 'true');
                userEmail.setAttribute('contenteditable', 'true');

                // Change the role to a select dropdown
                const roleSelect = document.createElement('select');
                roleSelect.innerHTML = `
                    <option value="admin" ${userRole.textContent === 'Admin' ? 'selected' : ''}>Admin</option>
                    <option value="manager" ${userRole.textContent === 'Manager' ? 'selected' : ''}>Manager</option>
                    <option value="employee" ${userRole.textContent === 'Employee' ? 'selected' : ''}>Employee</option>
                `;
                userRole.innerHTML = '';
                userRole.appendChild(roleSelect);

                row.querySelector('.save-btn').style.display = 'inline-block';
                row.querySelector('.edit-btn').style.display = 'none';
            });
        });

        // Save changes after edit
        saveButtons.forEach((saveBtn, index) => {
            saveBtn.addEventListener('click', function() {
                const row = userRows[index];
                const userId = row.querySelector('.user-id');
                const userName = row.querySelector('.user-name');
                const userEmail = row.querySelector('.user-email');
                const userRoleSelect = row.querySelector('.user-role select');

                // Validate user ID (should be numeric)
                if (!/^\d+$/.test(userId.textContent.trim())) {
                    alert('User ID must be numeric');
                    return;
                }

                // Save the selected role
                const userRole = userRoleSelect.value;
                userRole.innerHTML = userRole;

                // Make the fields non-editable again
                userId.setAttribute('contenteditable', 'false');
                userName.setAttribute('contenteditable', 'false');
                userEmail.setAttribute('contenteditable', 'false');

                // Replace the select with the selected value for role
                row.querySelector('.user-role').innerHTML = userRole;

                // Hide the save button and show the edit button again
                row.querySelector('.save-btn').style.display = 'none';
                row.querySelector('.edit-btn').style.display = 'inline-block';
            });
        });

        // Delete user row
        deleteButtons.forEach((deleteBtn, index) => {
            deleteBtn.addEventListener('click', function() {
                const row = userRows[index];
                if (confirm('Are you sure you want to delete this user?')) {
                    row.remove();
                }
            });
        });

        // Add new user functionality
        const addUserForm = document.getElementById('addUserForm');
        addUserForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const userId = document.getElementById('userId').value;
            const fullName = document.getElementById('fullName').value;
            const userEmail = document.getElementById('userEmail').value;
            const userRole = document.getElementById('userRole').value;

            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td class="user-id">${userId}</td>
                <td class="user-name">${fullName}</td>
                <td class="user-email">${userEmail}</td>
                <td class="user-role">${userRole}</td>
                <td>
                    <button class="action-btn edit-btn">Edit</button>
                    <button class="action-btn save-btn" style="display: none;">Save</button>
                    <button class="action-btn delete">Delete</button>
                </td>
            `;
            document.querySelector('.user-table tbody').appendChild(newRow);

            // Clear form
            addUserForm.reset();

            
        });
         // Search functionality
    searchInput.addEventListener('input', function() {
        const query = searchInput.value.toLowerCase();

        userRows.forEach(row => {
            const userName = row.querySelector('.user-name').textContent.toLowerCase();
            const userEmail = row.querySelector('.user-email').textContent.toLowerCase();

            if (userName.includes(query) || userEmail.includes(query)) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    });
    });
    </script>
  </body>
</html>
